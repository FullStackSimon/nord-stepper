{"version":3,"file":"ShortcutController-BIb3WGzH.js","sources":["../src/common/controllers/ShortcutController.ts"],"sourcesContent":["import { ReactiveController, ReactiveControllerHost } from \"lit\"\nimport type { KeyBindingMap } from \"tinykeys\"\nimport tinykeys from \"tinykeys\"\n\ntype ShortcutTarget = Parameters<typeof tinykeys>[0]\n\nconst ARROW_RE = /Arrow(Up|Down|Left|Right)/g\nconst ESC_RE = /Escape/g\n\nfunction normalise(shortcuts: KeyBindingMap) {\n  const normalised: KeyBindingMap = {}\n\n  Object.keys(shortcuts).forEach(keybinding => {\n    normalised[keybinding] = shortcuts[keybinding]\n\n    // Arrow and Escape keys in IE/Edge have different names\n    if (ARROW_RE.test(keybinding)) {\n      const mapped = keybinding.replace(ARROW_RE, (_match, capture) => capture)\n      normalised[mapped] = normalised[keybinding]\n    }\n    if (ESC_RE.test(keybinding)) {\n      const mapped = keybinding.replace(ESC_RE, () => \"Esc\")\n      normalised[mapped] = normalised[keybinding]\n    }\n  })\n\n  return normalised\n}\n\nexport class ShortcutController implements ReactiveController {\n  private unregister?: ReturnType<typeof tinykeys>\n\n  constructor(\n    host: ReactiveControllerHost,\n    private shortcuts?: KeyBindingMap,\n    private target?: ShortcutTarget\n  ) {\n    host.addController(this)\n  }\n\n  hostConnected() {\n    if (this.shortcuts) {\n      this.bind(this.shortcuts)\n    }\n  }\n\n  hostDisconnected() {\n    this.unbind()\n  }\n\n  unbind() {\n    this.unregister?.()\n  }\n\n  bind(shortcuts: KeyBindingMap) {\n    this.unbind()\n    this.shortcuts = shortcuts\n    this.unregister = tinykeys(this.target ?? window, normalise(this.shortcuts))\n  }\n}\n\nexport type { KeyBindingMap as ShortcutMap }\n"],"names":["ARROW_RE","ESC_RE","ShortcutController","constructor","host","shortcuts","target","this","addController","hostConnected","bind","hostDisconnected","unbind","_a","unregister","call","tinykeys","window","normalised","Object","keys","forEach","keybinding","test","mapped","replace","_match","capture","normalise"],"mappings":"kDAMA,MAAMA,EAAW,6BACXC,EAAS,gBAsBFC,EAGX,WAAAC,CACEC,EACQC,EACAC,GADAC,KAASF,UAATA,EACAE,KAAMD,OAANA,EAERF,EAAKI,cAAcD,KACpB,CAED,aAAAE,GACMF,KAAKF,WACPE,KAAKG,KAAKH,KAAKF,UAElB,CAED,gBAAAM,GACEJ,KAAKK,QACN,CAED,MAAAA,SACiB,QAAfC,EAAAN,KAAKO,kBAAU,IAAAD,GAAAA,EAAAE,KAAAR,KAChB,CAED,IAAAG,CAAKL,SACHE,KAAKK,SACLL,KAAKF,UAAYA,EACjBE,KAAKO,WAAaE,UAASH,EAAAN,KAAKD,sBAAUW,OAhD9C,SAAmBZ,GACjB,MAAMa,EAA4B,CAAA,EAgBlC,OAdAC,OAAOC,KAAKf,GAAWgB,SAAQC,IAI7B,GAHAJ,EAAWI,GAAcjB,EAAUiB,GAG/BtB,EAASuB,KAAKD,GAAa,CAC7B,MAAME,EAASF,EAAWG,QAAQzB,GAAU,CAAC0B,EAAQC,IAAYA,IACjET,EAAWM,GAAUN,EAAWI,EACjC,CACD,GAAIrB,EAAOsB,KAAKD,GAAa,CAC3B,MAAME,EAASF,EAAWG,QAAQxB,GAAQ,IAAM,QAChDiB,EAAWM,GAAUN,EAAWI,EACjC,KAGIJ,CACT,CA8BsDU,CAAUrB,KAAKF,WAClE"}